<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>My Electron Browser</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; background: #232946; color: #fff; }
    #controls { padding: 10px; background: #121629; display: flex; align-items: center; }
    #url { flex: 1; padding: 7px 12px; border-radius: 5px; border: none; font-size: 16px; }
    #go { margin-left: 8px; padding: 7px 18px; border-radius: 5px; border: none; background: #eebbc3; color: #232946; font-weight: bold; cursor: pointer; }
    #tabs { display: flex; background: #232946; }
    .tab { padding: 8px 20px; background: #4a4e69; margin-right: 2px; cursor: pointer; border-radius: 10px 10px 0 0; }
    .tab.active { background: #eebbc3; color: #232946; font-weight: bold; }
    .tab .close { margin-left: 7px; color: #fff; background: none; border: none; font-weight: bold; cursor: pointer; }
    #addTab { background: #121629; color: #eebbc3; border: none; font-size: 22px; border-radius: 50%; padding: 0 11px; margin-left: 8px; cursor: pointer; }
    #webviews { width: 100vw; height: calc(100vh - 80px); position: relative; }
    webview { width: 100%; height: 100%; display: none; border: none; }
    webview.active { display: block; }
  </style>
</head>
<body>
  <div id="controls">
    <input id="url" placeholder="Enter URL or search..." />
    <button id="go">Go</button>
  </div>
  <div id="tabs"></div>
  <div id="webviews"></div>
  <script>
    let tabs = [];
    let activeTab = 0;

    function addTab(url = 'https://www.google.com') {
      tabs.push({ url });
      renderTabs();
      renderWebviews();
      switchTab(tabs.length - 1);
    }

    function closeTab(idx) {
      if (tabs.length === 1) return;
      tabs.splice(idx, 1);
      if (activeTab >= tabs.length) activeTab = tabs.length - 1;
      renderTabs();
      renderWebviews();
      switchTab(activeTab);
    }

    function switchTab(idx) {
      activeTab = idx;
      renderTabs();
      renderWebviews();
      document.getElementById('url').value = tabs[activeTab].url;
    }

    function renderTabs() {
      let html = '';
      tabs.forEach((tab, i) => {
        html += `<div class="tab${i === activeTab ? ' active' : ''}" onclick="switchTab(${i})">
          Tab ${i+1}
          <button class="close" onclick="event.stopPropagation(); closeTab(${i});">&times;</button>
        </div>`;
      });
      html += `<button id="addTab" onclick="addTab()">+</button>`;
      document.getElementById('tabs').innerHTML = html;
    }

    function renderWebviews() {
      let html = '';
      tabs.forEach((tab, i) => {
        html += `<webview src="${tab.url}" class="${i === activeTab ? 'active' : ''}" id="webview${i}" allowpopups></webview>`;
      });
      document.getElementById('webviews').innerHTML = html;
    }

    function goToUrl() {
      let val = document.getElementById('url').value.trim();
      // If no protocol, treat as search
      if (!val.match(/^https?:\/\//)) {
        if (val.includes('.') && !val.includes(' ')) val = 'https://' + val;
        else val = 'https://www.google.com/search?q=' + encodeURIComponent(val);
      }
      tabs[activeTab].url = val;
      renderWebviews();
      switchTab(activeTab);
    }

    document.getElementById('go').onclick = goToUrl;
    document.getElementById('url').addEventListener('keydown', e => {
      if (e.key === 'Enter') goToUrl();
    });

    // Expose tab functions globally for inline handlers
    window.switchTab = switchTab;
    window.closeTab = closeTab;
    window.addTab = addTab;

    addTab(); // Initial tab
  </script>
</body>
</html>
